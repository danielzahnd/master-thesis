# nf-milne-eddington-example-2-nflows-piecewisequadratic
This code experiments with normalizing flows used to invert Milne-Eddington atmospheres. In this case, a map of a certain FOV of the sun is taken at three different times. These three maps are subsequently inverted using the Milne-Eddington algorithm. After that, train and test splits are made from the first map, which is then used to train a normalizing flow (piecewise quadratic method from nflows package). The trained normalizing flow is then used to invert the two other maps. Finally, the two inverted maps using the trained normalizing flow are compared with the same maps inverted by the Milne-Eddington algorithm. It provides an inital test for the idea, that inversions can be vastly accelerated by means of using normalizing flows. That is, a map is initially inverted using a (sophisticated) inversion algorithm. After that, a normalizing flow can be trained on this inverted map and then applied to similar FOV's and maps, thereby greatly accelerating the inversion and furthermore providing one with not only parameter values, but distributions!

Used data for this experiment can be found at [penumbra-formation-maps](https://drive.google.com/drive/folders/1-W3vCJC4gEsQWW0pzwF8PbQ3erE0eGPI?usp=drive_link/) and [sunspot-map](https://drive.google.com/drive/folders/1AM6oA1mLYQ_DtIlSv52aYXDNDTygRQyq?usp=drive_link).
