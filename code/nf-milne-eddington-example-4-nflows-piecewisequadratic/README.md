# nf-milne-eddington-example-4-nflows-piecewisequadratic (experiment 4 in thesis)
This code experiments with normalizing flows used to invert Milne-Eddington atmospheres. In this case, a normalizing flow is trained on a map of solar observations (Stokes parameters at different wavelengths for each pixel) and the associated inverted data, which was obtained by the Milne-Eddington algorithm. The trained normalizing flow is then used to invert maps of solar observations of a different FOV a three different times; namely observations from a penumbra formation. The normalizing-flow inverted data is compared to Milne-Eddington inverted data for the same maps. This further provides an inital test for the idea, that inversions can be vastly accelerated by means of using normalizing flows. That is, a map is initially inverted using a (sophisticated) inversion algorithm. After that, a normalizing flow can be trained on this inverted map and then applied to similar FOV's and maps, thereby greatly accelerating the inversion and furthermore providing one with not only parameter values, but distributions!

Used data for this experiment can be found at [penumbra-formation-maps](https://drive.google.com/drive/folders/1-W3vCJC4gEsQWW0pzwF8PbQ3erE0eGPI?usp=drive_link/), [sunspot-map](https://drive.google.com/drive/folders/1AM6oA1mLYQ_DtIlSv52aYXDNDTygRQyq?usp=drive_link) and [nf-milne-eddington-example-4-nflows-piecewisequadratic](https://drive.google.com/drive/folders/1zpo0ihtQLWejjSnsT6Iwf34b-D5xEwBP?usp=drive_link).
